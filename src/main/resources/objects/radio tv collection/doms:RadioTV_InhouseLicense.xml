<?xml version="1.0" encoding="UTF-8"?>

<foxml:digitalObject
        VERSION="1.1"
        PID="doms:RadioTV_InhouseLicense"
        xmlns:foxml="info:fedora/fedora-system:def/foxml#"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation=
                "info:fedora/fedora-system:def/foxml#
                http://www.fedora.info/definitions/1/0/foxml1-1.xsd"
        >

    <foxml:objectProperties>
        <foxml:property
                NAME="info:fedora/fedora-system:def/model#state"
                VALUE="A"/>
        <foxml:property
                NAME="info:fedora/fedora-system:def/model#label"
                VALUE="Radio/TV License for inhouse users"/>
    </foxml:objectProperties>

    <foxml:datastream ID="DC" STATE="A" CONTROL_GROUP="X" VERSIONABLE="true">
        <foxml:datastreamVersion ID="DC.0" MIMETYPE="text/xml" LABEL="Default Dublin Core Record"
                                 FORMAT_URI="http://www.openarchives.org/OAI/2.0/oai_dc/">

            <foxml:xmlContent>
                <oai_dc:dc xmlns:oai_dc="http://www.openarchives.org/OAI/2.0/oai_dc/" xmlns:dc="http://purl.org/dc/elements/1.1/">
                    <dc:title>Radio TV License</dc:title>
                    <dc:description>A license granting access to inhouse users</dc:description>
                    <dc:identifier>doms:RadioTV_InhouseLicense</dc:identifier>
                </oai_dc:dc>
            </foxml:xmlContent>
        </foxml:datastreamVersion>
    </foxml:datastream>

    <foxml:datastream CONTROL_GROUP="X" ID="RELS-EXT" STATE="A" VERSIONABLE="true">
        <foxml:datastreamVersion  ID="RELS-EXT.1" LABEL="Relationships"
                                  FORMAT_URI="info:fedora/fedora-system:FedoraRELSExt-1.0"
                                  MIMETYPE="application/rdf+xml" >
            <foxml:contentDigest DIGEST="none" TYPE="DISABLED"/>
            <foxml:xmlContent>
                <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
                         xmlns:doms="http://doms.statsbiblioteket.dk/relations/default/0/1/#">
                    <rdf:Description rdf:about="info:fedora/doms:RadioTV_InhouseLicense">
                        <hasModel rdf:resource="info:fedora/doms:ContentModel_License" xmlns="info:fedora/fedora-system:def/model#"/>
                        <hasModel rdf:resource="info:fedora/doms:ContentModel_DOMS" xmlns="info:fedora/fedora-system:def/model#"/>
                        <doms:isPartOfCollection rdf:resource="info:fedora/doms:RadioTV_Collection"/>
                        <doms:hasLicense rdf:resource="info:fedora/doms:Open_License"/>
                    </rdf:Description>
                </rdf:RDF>
            </foxml:xmlContent>
        </foxml:datastreamVersion>
    </foxml:datastream>

<!--
    <foxml:datastream
            CONTROL_GROUP="E"
            ID="POLICY"
            STATE="A"
            VERSIONABLE="true">
        <foxml:datastreamVersion
                ID="POLICY.0"
                LABEL="License for this object"
                MIMETYPE="application/rdf+xml">
            <foxml:contentDigest DIGEST="none" TYPE="DISABLED"/>
            <foxml:contentLocation REF="http://local.fedora.server/fedora/objects/doms:Open_License/datastreams/LICENSE/content" TYPE="URL"/>
        </foxml:datastreamVersion>
    </foxml:datastream>
-->

    <foxml:datastream ID="LICENSE" CONTROL_GROUP="X">
        <foxml:datastreamVersion ID="LICENSE.0" MIMETYPE="text/xml">
            <foxml:xmlContent>

                <Policy xmlns="urn:oasis:names:tc:xacml:1.0:policy" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" PolicyId="RadioTV_InhouseLicense" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable">
                    <Description>The is the license for the radio tv collection. Complete access is granted, if and only if, the user has the inhouse
                        or administrator or readonlyadministrator fedoraRole.
                    </Description>
                    <Target>
                        <Subjects>
                            <AnySubject></AnySubject>
                        </Subjects>
                        <Resources>
                            <AnyResource></AnyResource>
                        </Resources>
                        <Actions>
                            <AnyAction></AnyAction>
                        </Actions>
                    </Target>
                    <Rule Effect="Deny" RuleId="1">
                        <Condition FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-at-least-one-member-of">
                                <SubjectAttributeDesignator AttributeId="fedoraRole" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"></SubjectAttributeDesignator>
                                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-bag">
                                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">inhouse</AttributeValue>
                                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">administrator</AttributeValue>
                                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">readonlyadministrator</AttributeValue>
                                </Apply>
                            </Apply>
                        </Condition>
                    </Rule>
                </Policy>
            </foxml:xmlContent>
        </foxml:datastreamVersion>
    </foxml:datastream>

</foxml:digitalObject>
